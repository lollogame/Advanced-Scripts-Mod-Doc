<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Script Mod — Documentation</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0f12;
    --surface: #13161b;
    --surface2: #1a1e26;
    --border: #252932;
    --accent: #65ff87;
    --accent2: #38bdf8;
    --accent3: #f59e0b;
    --accent4: #c084fc;
    --text: #e2e8f0;
    --muted: #64748b;
    --code-bg: #0d1117;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Syne', sans-serif;
    font-size: 15px;
    line-height: 1.7;
    display: flex;
    min-height: 100vh;
  }
  nav {
    width: 260px;
    min-width: 260px;
    background: var(--surface);
    border-right: 1px solid var(--border);
    height: 100vh;
    position: sticky;
    top: 0;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    padding: 0 0 2rem;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }
  .nav-header {
    padding: 2rem 1.5rem 1.25rem;
    border-bottom: 1px solid var(--border);
    margin-bottom: 1rem;
  }
  .nav-logo { font-size: 1.1rem; font-weight: 800; color: var(--accent); letter-spacing: -0.5px; line-height: 1.2; }
  .nav-version { font-family: 'DM Mono', monospace; font-size: 0.7rem; color: var(--muted); margin-top: 0.3rem; }
  .nav-group-label { font-size: 0.65rem; font-weight: 700; letter-spacing: 0.12em; text-transform: uppercase; color: var(--muted); padding: 0.85rem 1.5rem 0.35rem; }
  nav a { display: block; padding: 0.32rem 1.5rem; color: #94a3b8; text-decoration: none; font-size: 0.82rem; font-weight: 400; transition: color 0.15s, background 0.15s; border-left: 2px solid transparent; }
  nav a:hover, nav a.active { color: var(--accent); background: rgba(74,222,128,0.06); border-left-color: var(--accent); }
  main { flex: 1; max-width: 900px; padding: 3rem 3.5rem; overflow-x: hidden; }
  .hero { border-bottom: 1px solid var(--border); padding-bottom: 2.5rem; margin-bottom: 3rem; position: relative; }
  .hero::before { content: ''; position: absolute; top: -3rem; left: -3.5rem; right: 0; bottom: 0; background: radial-gradient(ellipse at 30% 0%, rgba(74,222,128,0.07) 0%, transparent 60%); pointer-events: none; }
  .hero-tag { display: inline-block; font-family: 'DM Mono', monospace; font-size: 0.7rem; color: var(--accent); background: rgba(74,222,128,0.1); border: 1px solid rgba(74,222,128,0.25); border-radius: 4px; padding: 0.2rem 0.6rem; margin-bottom: 1rem; letter-spacing: 0.06em; }
  .hero h1 { font-size: 2.6rem; font-weight: 800; line-height: 1.1; letter-spacing: -1.5px; color: var(--text); margin-bottom: 0.8rem; }
  .hero h1 span { color: var(--accent); }
  .hero p { color: #94a3b8; font-size: 0.95rem; max-width: 580px; font-weight: 400; }
  section { margin-bottom: 4rem; scroll-margin-top: 2rem; }
  h2 { font-size: 1.35rem; font-weight: 700; letter-spacing: -0.5px; color: var(--text); margin-bottom: 1.25rem; padding-bottom: 0.6rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 0.6rem; }
  h2 .h2-icon { font-size: 1rem; opacity: 0.6; }
  h3 { font-size: 0.92rem; font-weight: 700; color: var(--accent2); text-transform: uppercase; letter-spacing: 0.08em; margin: 1.8rem 0 0.8rem; }
  pre { background: var(--code-bg); border: 1px solid var(--border); border-radius: 8px; padding: 1.25rem 1.5rem; overflow-x: auto; margin: 0.75rem 0 1.25rem; position: relative; }
  pre code { font-family: 'DM Mono', monospace; font-size: 0.8rem; line-height: 1.75; color: #cbd5e1; }
  code { font-family: 'DM Mono', monospace; font-size: 0.78rem; background: rgba(255,255,255,0.06); border: 1px solid var(--border); border-radius: 4px; padding: 0.1em 0.45em; color: var(--accent); }
  pre code { background: none; border: none; padding: 0; font-size: 0.8rem; }
  .k  { color: #c084fc; }
  .fn { color: #38bdf8; }
  .s  { color: #86efac; }
  .c  { color: #475569; font-style: italic; }
  .n  { color: #f59e0b; }
  .a  { color: #fb923c; }
  .op { color: #94a3b8; }
  .table-wrap { overflow-x: auto; margin: 0.75rem 0 1.5rem; border-radius: 8px; border: 1px solid var(--border); }
  table { width: 100%; border-collapse: collapse; font-size: 0.82rem; }
  thead { background: var(--surface2); }
  th { text-align: left; padding: 0.65rem 1rem; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; color: var(--muted); border-bottom: 1px solid var(--border); }
  td { padding: 0.6rem 1rem; border-bottom: 1px solid rgba(37,41,50,0.6); vertical-align: top; color: #cbd5e1; }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: rgba(255,255,255,0.02); }
  td:first-child code { color: var(--accent2); font-size: 0.77rem; }
  .callout { border-left: 3px solid; border-radius: 0 8px 8px 0; padding: 0.85rem 1.1rem; margin: 1rem 0; font-size: 0.84rem; }
  .callout.info    { border-color: var(--accent2); background: rgba(56,189,248,0.07); }
  .callout.warning { border-color: var(--accent3); background: rgba(245,158,11,0.07); }
  .callout strong  { font-weight: 700; }
  .chip { display: inline-block; font-family: 'DM Mono', monospace; font-size: 0.68rem; padding: 0.15rem 0.55rem; border-radius: 4px; font-weight: 500; margin-right: 0.3rem; vertical-align: middle; }
  .chip-green  { background: rgba(74,222,128,0.1); color: var(--accent); border: 1px solid rgba(74,222,128,0.25); }
  .chip-blue   { background: rgba(56,189,248,0.1); color: var(--accent2); border: 1px solid rgba(56,189,248,0.25); }
  .chip-yellow { background: rgba(245,158,11,0.1); color: var(--accent3); border: 1px solid rgba(245,158,11,0.25); }
  .chip-purple { background: rgba(192,132,252,0.1); color: var(--accent4); border: 1px solid rgba(192,132,252,0.25); }
  .grid2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 0.75rem 0 1.25rem; }
  .card { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 1rem 1.1rem; }
  .card h4 { font-size: 0.8rem; font-weight: 700; color: var(--accent4); margin-bottom: 0.5rem; }
  .card p  { font-size: 0.8rem; color: #94a3b8; line-height: 1.5; }
  @media (max-width: 960px) { main { padding: 2rem 1.5rem; } .grid2 { grid-template-columns: 1fr; } nav { display: none; } }
  @media (max-width: 1100px) { main { padding: 2.5rem 2rem; } }
</style>
</head>
<body>

<nav>
  <div class="nav-header">
    <div class="nav-logo">&#9881; Scripts</div>
    <div class="nav-version">Forge 1.20.1 &middot; v47.4.16</div>
  </div>

  <div class="nav-group-label">Getting Started</div>
  <a href="#overview">Overview</a>
  <a href="#annotations">Annotations</a>

  <div class="nav-group-label">Language</div>
  <a href="#types">Types &amp; Variables</a>
  <a href="#operators">Operators</a>
  <a href="#control">Control Flow</a>
  <a href="#functions">Functions</a>
  <a href="#macros">Macros</a>
  <a href="#imports">Import System</a>
  <a href="#preprocessor">Preprocessor</a>
  <a href="#fstrings">F-Strings</a>
  <a href="#scope">Scope &amp; Global</a>

  <div class="nav-group-label">Built-ins</div>
  <a href="#builtins-general">General Functions</a>
  <a href="#builtins-list">List Methods</a>
  <a href="#builtins-dict">Dict Methods</a>
  <a href="#builtins-str">String Methods</a>

  <div class="nav-group-label">Database</div>
  <a href="#database">DB Functions</a>

  <div class="nav-group-label">Minecraft API</div>
  <a href="#mc-commands">Server Commands</a>
  <a href="#mc-player">Player</a>
  <a href="#mc-world">World</a>
  <a href="#mc-server">Server</a>
  <a href="#mc-blocks">Blocks</a>
  <a href="#mc-entities">Entities</a>
  <a href="#mc-nbt">NBT Snapshots</a>

  <div class="nav-group-label">Execution</div>
  <a href="#threading">Threading</a>
  <a href="#module-cache">Module Cache</a>
  <a href="#examples">Examples</a>
</nav>

<main>

  <div class="hero">
    <div class="hero-tag">Documentation &middot; python-like scripting</div>
    <h1>Advanced<span>Scripts</span>Mod</h1>
    <p>A full Python-like scripting language embedded directly into your Minecraft Forge 1.20.1. Write scripts with variables, loops, functions, imports, and deep access to live server data</p>
  </div>

  <section id="overview">
    <h2><span class="h2-icon">&#128196;</span>Overview</h2>
    <p>Scripts are plain-text <code>.script</code> files placed inside the <code>scripts/</code> folder at the root of your server directory. Each script runs on its own background thread, so blocking calls like <code>wait()</code> never stall the server. Subdirectories are supported and are used for import paths.</p>
    <div class="grid2" style="margin-top:1.25rem;">
      <div class="card"><h4>Script Folder</h4><p><code>server/scripts/</code><br>Subfolders map to import paths. e.g. <code>utils/math.script</code> &rarr; <code>import utils.math</code></p></div>
      <div class="card"><h4>Threading Model</h4><p>Every script runs in its own daemon thread. Commands and queries are dispatched to the server thread via a <code>CountDownLatch</code>, keeping both threads safe.</p></div>
    </div>
  </section>

  <section id="annotations">
    <h2><span class="h2-icon">&#127991;</span>Annotations</h2>
    <p>Annotations must appear as the <strong>very first non-blank, non-comment line</strong> of the file.</p>
    <div class="table-wrap"><table>
      <thead><tr><th>Annotation</th><th>Behavior</th></tr></thead>
      <tbody>
        <tr><td><code>@PREPARE</code></td><td>Auto-executed at server start and on <code>/scripts reload</code>.</td></tr>
        <tr><td><code>@LIBRARY</code></td><td>When imported, only <code>def</code> definitions and top-level variable assignments are exported. Commands and <code>print()</code> calls are skipped.</td></tr>
        <tr><td><code>@RUN</code></td><td>When imported, the entire top-level code runs. Overrides the <code>@LIBRARY</code> default.</td></tr>
      </tbody>
    </table></div>
    <pre><code><span class="a">@PREPARE</span>
<span class="c"># This script runs automatically at server start</span>
<span class="fn">print</span>(<span class="s">"Server ready!"</span>)
global_var <span class="op">=</span> <span class="n">42</span></code></pre>
    <div class="callout info"><strong>Note:</strong> A file with no annotation behaves like <code>@LIBRARY</code>.</div>
  </section>

  <section id="types">
    <h2><span class="h2-icon">&#128291;</span>Types &amp; Variables</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Type</th><th>Literal Example</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td><code>int</code></td><td><code>42</code>, <code>-7</code></td><td>Java <code>Integer</code> or <code>Long</code></td></tr>
        <tr><td><code>float</code></td><td><code>3.14</code></td><td>Java <code>Double</code></td></tr>
        <tr><td><code>str</code></td><td><code>"hello"</code>, triple-quoted</td><td>Escape sequences <code>\n \t \r \\ \" \'</code></td></tr>
        <tr><td><code>bool</code></td><td><code>True</code>, <code>False</code></td><td>Case-sensitive</td></tr>
        <tr><td><code>None</code></td><td><code>None</code></td><td>Null value</td></tr>
        <tr><td><code>list</code></td><td><code>[1, "a", True]</code></td><td>Mixed types, mutable, 0-indexed, negative indexing</td></tr>
        <tr><td><code>dict</code></td><td><code>{"key": value}</code></td><td>String keys only</td></tr>
      </tbody>
    </table></div>
    <pre><code>x <span class="op">=</span> <span class="n">10</span>
x <span class="op">+=</span> <span class="n">5</span>
items <span class="op">=</span> [<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]
items[<span class="n">0</span>] <span class="op">=</span> <span class="n">99</span>
data <span class="op">=</span> {<span class="s">"hp"</span>: <span class="n">20</span>}
data[<span class="s">"hp"</span>] <span class="op">=</span> <span class="n">18</span></code></pre>
  </section>

  <section id="operators">
    <h2><span class="h2-icon">&#10133;</span>Operators</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Category</th><th>Operators</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Arithmetic</td><td><code>+  -  *  /  //  %  **</code></td><td><code>//</code> floor div, <code>**</code> power. <code>+</code> concatenates lists and strings.</td></tr>
        <tr><td>Comparison</td><td><code>==  !=  &lt;  &gt;  &lt;=  &gt;=</code></td><td>Double precision</td></tr>
        <tr><td>Logical</td><td><code>and  or  not</code></td><td>Short-circuit evaluation</td></tr>
        <tr><td>Membership</td><td><code>in  not in</code></td><td>list, dict (by key), str</td></tr>
        <tr><td>Unary</td><td><code>-  +</code></td><td></td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="control">
    <h2><span class="h2-icon">&#128256;</span>Control Flow</h2>
    <h3>if / elif / else</h3>
    <pre><code><span class="k">if</span> hp <span class="op">&lt;</span> <span class="n">5</span>:
    <span class="fn">print</span>(<span class="s">"critical!"</span>)
<span class="k">elif</span> hp <span class="op">&lt;</span> <span class="n">10</span>:
    <span class="fn">print</span>(<span class="s">"low health"</span>)
<span class="k">else</span>:
    <span class="fn">print</span>(<span class="s">"fine"</span>)</code></pre>
    <h3>for</h3>
    <pre><code><span class="k">for</span> i <span class="k">in</span> <span class="fn">range</span>(<span class="n">5</span>):
    <span class="fn">print</span>(i)
<span class="k">for</span> name, score <span class="k">in</span> [[<span class="s">"Alice"</span>, <span class="n">10</span>], [<span class="s">"Bob"</span>, <span class="n">5</span>]]:
    <span class="fn">print</span>(name, score)</code></pre>
    <h3>while / break / continue / pass</h3>
    <pre><code>count <span class="op">=</span> <span class="n">0</span>
<span class="k">while</span> count <span class="op">&lt;</span> <span class="n">3</span>:
    count <span class="op">+=</span> <span class="n">1</span>
    <span class="fn">wait</span>(<span class="n">20</span>)</code></pre>
  </section>

  <section id="functions">
    <h2><span class="h2-icon">&#128230;</span>Functions</h2>
    <pre><code><span class="k">def</span> <span class="fn">greet</span>(player, msg<span class="op">=</span><span class="s">"Welcome!"</span>):
    /say {player}: {msg}

<span class="k">def</span> <span class="fn">add</span>(a, b):
    <span class="k">return</span> a <span class="op">+</span> b

result <span class="op">=</span> <span class="fn">add</span>(<span class="n">3</span>, <span class="n">4</span>)   <span class="c"># 7</span></code></pre>
    <div class="callout info"><strong>First-pass scan:</strong> All <code>def</code> statements are registered before any code executes.</div>
  </section>

  <section id="macros">
    <h2><span class="h2-icon">&#129668;</span>Macros (<code>@macro</code>)</h2>
    <p>A macro runs inside the <strong>caller's scope</strong>. Variables assigned inside a macro are set directly on the caller.</p>
    <pre><code><span class="a">@macro</span>
<span class="k">def</span> <span class="fn">GIVE_DIAMOND</span>(player):
    /give {player} minecraft:diamond <span class="n">64</span>
    gave_diamond <span class="op">=</span> <span class="k">True</span>

<span class="fn">GIVE_DIAMOND</span>(<span class="s">"Steve"</span>)
<span class="fn">print</span>(gave_diamond)   <span class="c"># True</span></code></pre>
  </section>

  <section id="imports">
    <h2><span class="h2-icon">&#128229;</span>Import System</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Syntax</th><th>Result</th></tr></thead>
      <tbody>
        <tr><td><code>import utils</code></td><td>Bind module to <code>utils</code>. Call via <code>utils.greet()</code></td></tr>
        <tr><td><code>import utils as u</code></td><td>Alias as <code>u</code></td></tr>
        <tr><td><code>import path.to.lib</code></td><td>Loads <code>scripts/path/to/lib.script</code></td></tr>
        <tr><td><code>from utils import *</code></td><td>Inject all into current scope</td></tr>
        <tr><td><code>from utils import greet as hi, MAX as LIMIT</code></td><td>Named aliases</td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="preprocessor">
    <h2><span class="h2-icon">&#128295;</span>Preprocessor (<code>#define</code>)</h2>
    <pre><code><span class="a">#define MAX_HP 20</span>
<span class="a">#define SPAWN_MSG "Spawning entity now"</span>
hp <span class="op">=</span> MAX_HP        <span class="c"># becomes: hp = 20</span>
<span class="fn">print</span>(SPAWN_MSG)</code></pre>
  </section>

  <section id="fstrings">
    <h2><span class="h2-icon">&#128172;</span>F-Strings</h2>
    <pre><code>name <span class="op">=</span> <span class="s">"Steve"</span>
hp   <span class="op">=</span> <span class="n">18</span>
msg  <span class="op">=</span> f<span class="s">"Player {name} has {hp} HP ({hp / 20 * 100}%)"</span>
/say Hello, {name}!
/give {name} minecraft:apple {hp <span class="op">*</span> <span class="n">2</span>}</code></pre>
  </section>

  <section id="scope">
    <h2><span class="h2-icon">&#127760;</span>Scope &amp; <code>global</code></h2>
    <pre><code>counter <span class="op">=</span> <span class="n">0</span>
<span class="k">def</span> <span class="fn">increment</span>():
    <span class="k">global</span> counter
    counter <span class="op">+=</span> <span class="n">1</span>
<span class="fn">increment</span>()
<span class="fn">print</span>(counter)   <span class="c"># 1</span></code></pre>
  </section>

  <section id="builtins-general">
    <h2><span class="h2-icon">&#128297;</span>Built-in Functions</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Signature</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>print</code></td><td><code>print(*args)</code></td><td>Logs to server console with <code>[Script]</code> prefix</td></tr>
        <tr><td><code>wait</code></td><td><code>wait(ticks)</code></td><td>Pauses script. 20 ticks = 1 second. Interruptible.</td></tr>
        <tr><td><code>len</code></td><td><code>len(obj)</code></td><td><code>int</code></td></tr>
        <tr><td><code>str</code></td><td><code>str(val)</code></td><td>Convert to string</td></tr>
        <tr><td><code>int</code></td><td><code>int(val)</code></td><td>Convert to integer</td></tr>
        <tr><td><code>float</code></td><td><code>float(val)</code></td><td>Convert to float</td></tr>
        <tr><td><code>bool</code></td><td><code>bool(val)</code></td><td>Truthiness as boolean</td></tr>
        <tr><td><code>abs</code></td><td><code>abs(n)</code></td><td>Absolute value</td></tr>
        <tr><td><code>min</code></td><td><code>min(*args)</code> or <code>min(list)</code></td><td>Minimum</td></tr>
        <tr><td><code>max</code></td><td><code>max(*args)</code> or <code>max(list)</code></td><td>Maximum</td></tr>
        <tr><td><code>round</code></td><td><code>round(n, digits=0)</code></td><td>Rounded number</td></tr>
        <tr><td><code>sum</code></td><td><code>sum(list)</code></td><td>Sum of all numeric items</td></tr>
        <tr><td><code>range</code></td><td><code>range(stop)</code> / <code>range(start, stop, step)</code></td><td><code>list</code> of integers</td></tr>
        <tr><td><code>list</code></td><td><code>list(iterable?)</code></td><td>New list</td></tr>
        <tr><td><code>dict</code></td><td><code>dict()</code></td><td>New empty dict</td></tr>
        <tr><td><code>type</code></td><td><code>type(val)</code></td><td><code>"int"</code>, <code>"float"</code>, <code>"bool"</code>, <code>"str"</code>, <code>"list"</code>, <code>"dict"</code>, <code>"module"</code></td></tr>
        <tr><td><code>sorted</code></td><td><code>sorted(list)</code></td><td>New sorted list</td></tr>
        <tr><td><code>reversed</code></td><td><code>reversed(list)</code></td><td>New reversed list</td></tr>
        <tr><td><code>enumerate</code></td><td><code>enumerate(list, start=0)</code></td><td>List of <code>[index, item]</code></td></tr>
        <tr><td><code>zip</code></td><td><code>zip(list1, list2)</code></td><td>List of <code>[a, b]</code> pairs</td></tr>
        <tr><td><code>hasattr</code></td><td><code>hasattr(module, name)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>getattr</code></td><td><code>getattr(module, name, default)</code></td><td>Module member or default</td></tr>
        <tr><td><code>input</code></td><td><code>input()</code></td><td>Always <code>""</code></td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="builtins-list">
    <h2><span class="h2-icon">&#128203;</span>List Methods</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Method</th><th>Description</th></tr></thead>
      <tbody>
        <tr><td><code>list.append(val)</code></td><td>Add item to end</td></tr>
        <tr><td><code>list.extend(other)</code></td><td>Add all items from another list</td></tr>
        <tr><td><code>list.insert(i, val)</code></td><td>Insert at index</td></tr>
        <tr><td><code>list.remove(val)</code></td><td>Remove first occurrence</td></tr>
        <tr><td><code>list.pop(i=-1)</code></td><td>Remove and return item at index</td></tr>
        <tr><td><code>list.clear()</code></td><td>Remove all items</td></tr>
        <tr><td><code>list.sort()</code></td><td>In-place numeric sort</td></tr>
        <tr><td><code>list.reverse()</code></td><td>In-place reverse</td></tr>
        <tr><td><code>list.copy()</code></td><td>Shallow copy</td></tr>
        <tr><td><code>list.count(val)</code></td><td>Count occurrences</td></tr>
        <tr><td><code>list.index(val)</code></td><td>Index of first occurrence or <code>-1</code></td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="builtins-dict">
    <h2><span class="h2-icon">&#128194;</span>Dict Methods</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Method</th><th>Description</th></tr></thead>
      <tbody>
        <tr><td><code>dict.get(key, default)</code></td><td>Get value or default</td></tr>
        <tr><td><code>dict.keys()</code></td><td>List of all keys</td></tr>
        <tr><td><code>dict.values()</code></td><td>List of all values</td></tr>
        <tr><td><code>dict.items()</code></td><td>List of <code>[key, value]</code> pairs</td></tr>
        <tr><td><code>dict.pop(key)</code></td><td>Remove and return value</td></tr>
        <tr><td><code>dict.update(other)</code></td><td>Merge another dict</td></tr>
        <tr><td><code>dict.clear()</code></td><td>Remove all entries</td></tr>
        <tr><td><code>dict.copy()</code></td><td>Shallow copy</td></tr>
        <tr><td><code>dict.setdefault(key, val)</code></td><td>Set and return if key absent</td></tr>
        <tr><td><code>dict.has_key(key)</code></td><td>Boolean key existence check</td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="builtins-str">
    <h2><span class="h2-icon">&#128292;</span>String Methods</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Method</th><th>Description</th></tr></thead>
      <tbody>
        <tr><td><code>str.upper()</code> / <code>str.lower()</code></td><td>Case conversion</td></tr>
        <tr><td><code>str.strip()</code> / <code>str.lstrip()</code> / <code>str.rstrip()</code></td><td>Trim whitespace</td></tr>
        <tr><td><code>str.split(sep)</code></td><td>Split on separator. Returns list.</td></tr>
        <tr><td><code>str.join(list)</code></td><td>Join list items with separator</td></tr>
        <tr><td><code>str.replace(old, new)</code></td><td>Replace all occurrences</td></tr>
        <tr><td><code>str.startswith(prefix)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>str.endswith(suffix)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>str.contains(sub)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>str.find(sub)</code></td><td>First index of substring, or <code>-1</code></td></tr>
        <tr><td><code>str.count(sub)</code></td><td>Number of non-overlapping occurrences</td></tr>
        <tr><td><code>str.format(*args)</code></td><td>Replace <code>{}</code> placeholders in order</td></tr>
        <tr><td><code>str.zfill(width)</code></td><td>Zero-pad to width</td></tr>
        <tr><td><code>str.isdigit()</code></td><td><code>bool</code></td></tr>
        <tr><td><code>str.isalpha()</code></td><td><code>bool</code></td></tr>
        <tr><td><code>str.isalnum()</code></td><td><code>bool</code></td></tr>
      </tbody>
    </table></div>
  </section>

  <!-- DATABASE -->
  <section id="database">
    <h2><span class="h2-icon">&#128451;</span>Database Functions</h2>
    <p>The script engine includes a lightweight JSON-based key-value store. Each <strong>table</strong> is a separate file saved at <code>scripts/data/&lt;table&gt;.json</code>. No SQL, no setup — just read and write values by key.</p>

    <div class="callout info">
      <strong>Persistence:</strong> Data survives server restarts. Files are created automatically on first write. Supported value types: <code>int</code>, <code>float</code>, <code>str</code>, <code>bool</code>, <code>None</code>.
    </div>

    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Signature</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>db_set</code></td><td><code>db_set(table, key, value)</code></td><td><code>None</code> — write or overwrite a key</td></tr>
        <tr><td><code>db_get</code></td><td><code>db_get(table, key, default?)</code></td><td>Stored value, or <code>default</code> (<code>None</code>) if key absent</td></tr>
        <tr><td><code>db_exist</code></td><td><code>db_exist(table)</code></td><td><code>bool</code> — table file exists on disk</td></tr>
        <tr><td><code>db_has</code></td><td><code>db_has(table, key)</code></td><td><code>bool</code> — key exists in table</td></tr>
        <tr><td><code>db_keys</code></td><td><code>db_keys(table)</code></td><td><code>list[str]</code> — all keys in the table</td></tr>
        <tr><td><code>db_all</code></td><td><code>db_all(table)</code></td><td><code>dict</code> — full table as a dict</td></tr>
        <tr><td><code>db_delete</code></td><td><code>db_delete(table, key)</code></td><td><code>None</code> — remove a single key</td></tr>
        <tr><td><code>db_clear</code></td><td><code>db_clear(table)</code></td><td><code>None</code> — empty the table (file kept)</td></tr>
        <tr><td><code>db_tables</code></td><td><code>db_tables()</code></td><td><code>list[str]</code> — names of all existing tables</td></tr>
        <tr><td><code>db_drop</code></td><td><code>db_drop(table)</code></td><td><code>bool</code> — delete the table file from disk</td></tr>
      </tbody>
    </table></div>

    <h3>Basic usage</h3>
    <pre><code><span class="c"># Write values</span>
<span class="fn">db_set</span>(<span class="s">"players"</span>, <span class="s">"Steve_kills"</span>, <span class="n">42</span>)
<span class="fn">db_set</span>(<span class="s">"players"</span>, <span class="s">"Steve_coins"</span>, <span class="n">100</span>)

<span class="c"># Read values (with optional default)</span>
kills <span class="op">=</span> <span class="fn">db_get</span>(<span class="s">"players"</span>, <span class="s">"Steve_kills"</span>)          <span class="c"># 42</span>
coins <span class="op">=</span> <span class="fn">db_get</span>(<span class="s">"players"</span>, <span class="s">"Steve_money"</span>, <span class="n">0</span>)       <span class="c"># 0  (default)</span>

<span class="c"># Existence checks</span>
<span class="fn">db_exist</span>(<span class="s">"players"</span>)                                  <span class="c"># True</span>
<span class="fn">db_has</span>(<span class="s">"players"</span>, <span class="s">"Steve_kills"</span>)                    <span class="c"># True</span>

<span class="c"># Enumerate</span>
<span class="fn">print</span>(<span class="fn">db_keys</span>(<span class="s">"players"</span>))                            <span class="c"># ["Steve_kills", "Steve_coins"]</span>
<span class="fn">print</span>(<span class="fn">db_all</span>(<span class="s">"players"</span>))                             <span class="c"># {"Steve_kills": 42, "Steve_coins": 100}</span>
<span class="fn">print</span>(<span class="fn">db_tables</span>())                                    <span class="c"># ["players"]</span>

<span class="c"># Cleanup</span>
<span class="fn">db_delete</span>(<span class="s">"players"</span>, <span class="s">"Steve_kills"</span>)
<span class="fn">db_clear</span>(<span class="s">"players"</span>)                                   <span class="c"># empties the table</span>
<span class="fn">db_drop</span>(<span class="s">"players"</span>)                                    <span class="c"># deletes the file</span></code></pre>

    <h3>Example — coin economy</h3>
    <pre><code><span class="a">@PREPARE</span>
<span class="k">while</span> <span class="k">True</span>:
    <span class="k">for</span> name <span class="k">in</span> <span class="fn">player_list</span>():
        <span class="c"># Init player on first login</span>
        <span class="k">if</span> <span class="k">not</span> <span class="fn">db_has</span>(<span class="s">"economy"</span>, name <span class="op">+</span> <span class="s">"_coins"</span>):
            <span class="fn">db_set</span>(<span class="s">"economy"</span>, name <span class="op">+</span> <span class="s">"_coins"</span>, <span class="n">0</span>)

        <span class="c"># Award 1 coin every 5 minutes of play</span>
        coins <span class="op">=</span> <span class="fn">db_get</span>(<span class="s">"economy"</span>, name <span class="op">+</span> <span class="s">"_coins"</span>, <span class="n">0</span>)
        <span class="fn">db_set</span>(<span class="s">"economy"</span>, name <span class="op">+</span> <span class="s">"_coins"</span>, coins <span class="op">+</span> <span class="n">1</span>)
        /tell {name} &sect;6+1 coin! Total: {coins + 1}

    <span class="fn">wait</span>(<span class="n">6000</span>)   <span class="c"># 5 minutes</span></code></pre>

    <div class="callout warning">
      <strong>Concurrency note:</strong> Each <code>db_set</code> / <code>db_get</code> reads and writes the JSON file synchronously. If two scripts write the same table simultaneously, last write wins. Keep writes coarse-grained for high-frequency updates.
    </div>
  </section>

  <section id="mc-commands">
    <h2><span class="h2-icon">&#9876;</span>Server Commands</h2>
    <p>Any line starting with <code>/</code> is executed as a server command (permission level 4). Expressions inside <code>{}</code> are evaluated before execution.</p>
    <pre><code>player <span class="op">=</span> <span class="s">"Steve"</span>
/gamemode creative {player}
/give {player} minecraft:diamond_sword <span class="n">1</span>
/tp {player} <span class="n">0</span> <span class="n">64</span> <span class="n">0</span></code></pre>
    <div class="callout warning"><strong>Thread-safe:</strong> Commands are dispatched to the server thread. Timeout is 10 seconds.</div>
  </section>

  <section id="mc-player">
    <h2><span class="h2-icon">&#129485;</span>Player Functions</h2>
    <h3>Presence &amp; Count</h3>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>player_online(name)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>player_list()</code></td><td><code>list[str]</code> — all online player names</td></tr>
        <tr><td><code>player_count()</code></td><td><code>int</code></td></tr>
      </tbody>
    </table></div>
    <h3>Stats</h3>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>player_health(name)</code></td><td><code>float</code></td></tr>
        <tr><td><code>player_max_health(name)</code></td><td><code>float</code></td></tr>
        <tr><td><code>player_hunger(name)</code></td><td><code>int</code> (0–20)</td></tr>
        <tr><td><code>player_saturation(name)</code></td><td><code>float</code></td></tr>
        <tr><td><code>player_level(name)</code></td><td><code>int</code></td></tr>
        <tr><td><code>player_xp(name)</code></td><td><code>float</code> (0.0–1.0)</td></tr>
        <tr><td><code>player_total_xp(name)</code></td><td><code>int</code></td></tr>
        <tr><td><code>player_gamemode(name)</code></td><td><code>"survival"</code> / <code>"creative"</code> / <code>"adventure"</code> / <code>"spectator"</code></td></tr>
      </tbody>
    </table></div>
    <h3>Position &amp; Rotation</h3>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>player_x(name)</code> / <code>player_y(name)</code> / <code>player_z(name)</code></td><td><code>float</code></td></tr>
        <tr><td><code>player_pos(name)</code></td><td><code>[x, y, z]</code></td></tr>
        <tr><td><code>player_yaw(name)</code> / <code>player_pitch(name)</code></td><td><code>float</code></td></tr>
        <tr><td><code>player_dimension(name)</code></td><td><code>"overworld"</code> / <code>"the_nether"</code> / <code>"the_end"</code></td></tr>
      </tbody>
    </table></div>
    <h3>State Flags</h3>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>player_flying(name)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>player_sneaking(name)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>player_sprinting(name)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>player_on_ground(name)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>player_in_water(name)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>player_is_op(name)</code></td><td><code>bool</code></td></tr>
      </tbody>
    </table></div>
    <h3>Inventory</h3>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>player_inventory(name)</code></td><td>List of <code>{"slot", "id", "count", "name"}</code> dicts</td></tr>
        <tr><td><code>player_hand(name)</code></td><td><code>{"id", "count", "name"}</code></td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="mc-world">
    <h2><span class="h2-icon">&#127757;</span>World Functions</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>world_time()</code></td><td><code>int</code> — total game ticks</td></tr>
        <tr><td><code>world_day_time()</code></td><td><code>int</code> — ticks within day (0–23999)</td></tr>
        <tr><td><code>world_day()</code></td><td><code>int</code></td></tr>
        <tr><td><code>world_weather()</code></td><td><code>"clear"</code> / <code>"rain"</code> / <code>"thunder"</code></td></tr>
        <tr><td><code>world_difficulty()</code></td><td><code>"peaceful"</code> / <code>"easy"</code> / <code>"normal"</code> / <code>"hard"</code></td></tr>
        <tr><td><code>world_spawn()</code></td><td><code>[x, y, z]</code></td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="mc-server">
    <h2><span class="h2-icon">&#128421;</span>Server Functions</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>server_max_players()</code></td><td><code>int</code></td></tr>
        <tr><td><code>server_tps()</code></td><td><code>float</code> (max 20.0)</td></tr>
        <tr><td><code>server_mspt()</code></td><td><code>float</code></td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="mc-blocks">
    <h2><span class="h2-icon">&#129521;</span>Block Functions</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>block_at(x, y, z)</code></td><td><code>str</code> block ID, e.g. <code>"minecraft:stone"</code></td></tr>
        <tr><td><code>block_at(x, y, z, dim)</code></td><td>Same in specified dimension</td></tr>
        <tr><td><code>block_is_air(x, y, z)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>block_light(x, y, z)</code></td><td><code>int</code> 0–15</td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="mc-entities">
    <h2><span class="h2-icon">&#128009;</span>Entity Functions</h2>
    <p>All entity functions accept a standard Minecraft <strong>entity selector</strong>: <code>"@e"</code>, <code>"@e[type=zombie]"</code>, <code>"@e[limit=1,sort=nearest]"</code>, etc.</p>
    <div class="table-wrap"><table>
      <thead><tr><th>Function</th><th>Returns</th></tr></thead>
      <tbody>
        <tr><td><code>entity_count(sel)</code></td><td><code>int</code></td></tr>
        <tr><td><code>entity_list(sel)</code></td><td>List of entity dicts</td></tr>
        <tr><td><code>entity_type(sel)</code></td><td><code>str</code> e.g. <code>"minecraft:zombie"</code></td></tr>
        <tr><td><code>entity_name(sel)</code></td><td><code>str</code></td></tr>
        <tr><td><code>entity_uuid(sel)</code></td><td><code>str</code></td></tr>
        <tr><td><code>entity_x/y/z(sel)</code></td><td><code>float</code></td></tr>
        <tr><td><code>entity_pos(sel)</code></td><td><code>[x, y, z]</code></td></tr>
        <tr><td><code>entity_yaw/pitch(sel)</code></td><td><code>float</code></td></tr>
        <tr><td><code>entity_dimension(sel)</code></td><td><code>str</code></td></tr>
        <tr><td><code>entity_velocity(sel)</code></td><td><code>[vx, vy, vz]</code></td></tr>
        <tr><td><code>entity_health(sel)</code> / <code>entity_max_health(sel)</code></td><td><code>float</code></td></tr>
        <tr><td><code>entity_alive(sel)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>entity_on_fire/on_ground/in_water/silent/no_gravity/is_baby(sel)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>entity_tags(sel)</code></td><td><code>list[str]</code></td></tr>
        <tr><td><code>entity_has_tag(sel, tag)</code></td><td><code>bool</code></td></tr>
        <tr><td><code>entity_nbt(sel)</code></td><td><code>dict</code></td></tr>
        <tr><td><code>entity_nbt_all(sel)</code></td><td><code>list[dict]</code></td></tr>
        <tr><td><code>entity_nbt_tag(sel, tag)</code></td><td>any</td></tr>
      </tbody>
    </table></div>
  </section>

  <section id="mc-nbt">
    <h2><span class="h2-icon">&#128452;</span>NBT Snapshots</h2>
    <h3>player_nbt(name) fields</h3>
    <div class="table-wrap"><table>
      <thead><tr><th>Key</th><th>Type</th><th>Description</th></tr></thead>
      <tbody>
        <tr><td><code>Health</code> / <code>MaxHealth</code></td><td>float</td><td>HP</td></tr>
        <tr><td><code>FoodLevel</code></td><td>int</td><td>0–20</td></tr>
        <tr><td><code>XpLevel</code> / <code>XpProgress</code> / <code>TotalXp</code></td><td>int/float/int</td><td></td></tr>
        <tr><td><code>GameMode</code></td><td>str</td><td></td></tr>
        <tr><td><code>PosX</code> / <code>PosY</code> / <code>PosZ</code></td><td>float</td><td>Position</td></tr>
        <tr><td><code>Yaw</code> / <code>Pitch</code></td><td>float</td><td>Rotation</td></tr>
        <tr><td><code>Dimension</code></td><td>str</td><td></td></tr>
        <tr><td><code>Flying</code> / <code>Sneaking</code> / <code>Sprinting</code> / <code>OnGround</code> / <code>InWater</code> / <code>IsOp</code></td><td>bool</td><td></td></tr>
        <tr><td><code>Name</code> / <code>UUID</code></td><td>str</td><td></td></tr>
      </tbody>
    </table></div>
    <pre><code>nbt <span class="op">=</span> <span class="fn">player_nbt</span>(<span class="s">"Steve"</span>)
<span class="fn">print</span>(nbt[<span class="s">"Health"</span>], nbt[<span class="s">"XpLevel"</span>])
tag <span class="op">=</span> <span class="fn">player_nbt_tag</span>(<span class="s">"Steve"</span>, <span class="s">"Dimension"</span>)</code></pre>
  </section>

  <section id="threading">
    <h2><span class="h2-icon">&#129525;</span>Threading &amp; Lifecycle</h2>
    <div class="table-wrap"><table>
      <thead><tr><th>Behavior</th><th>Details</th></tr></thead>
      <tbody>
        <tr><td>Thread interrupt</td><td><code>/scripts stop</code> sets the interrupt flag; the interpreter checks it at every statement boundary and inside <code>wait()</code>.</td></tr>
        <tr><td>Timeout</td><td>Every server query and command has a 10-second timeout.</td></tr>
        <tr><td>Duplicate prevention</td><td>Cannot start a script that is already running by name.</td></tr>
        <tr><td>Daemon threads</td><td>Do not prevent JVM shutdown.</td></tr>
      </tbody>
    </table></div>
    <pre><code><span class="c"># /scripts reload  — clears module cache and runs all @PREPARE scripts</span>
<span class="c"># /scripts run events/greet</span>
<span class="c"># /scripts stop events/greet</span>
<span class="c"># /scripts stopall</span></code></pre>
  </section>

  <section id="module-cache">
    <h2><span class="h2-icon">&#9889;</span>Module Cache</h2>
    <p>Imported modules are parsed once and stored in a thread-safe cache. Subsequent <code>import</code> statements reuse the cached module without re-reading the file.</p>
    <div class="callout warning"><strong>Hot-reload:</strong> Run <code>/scripts reload</code> after editing a library file to clear the cache.</div>
  </section>

  <section id="examples">
    <h2><span class="h2-icon">&#128218;</span>Examples</h2>

    <h3>Auto-broadcast &amp; loop</h3>
    <pre><code><span class="a">@PREPARE</span>
messages <span class="op">=</span> [<span class="s">"Welcome!"</span>, <span class="s">"Visit our Discord!"</span>, <span class="s">"Type /help"</span>]
idx <span class="op">=</span> <span class="n">0</span>
<span class="k">while</span> <span class="k">True</span>:
    /say {messages[idx]}
    idx <span class="op">=</span> (idx <span class="op">+</span> <span class="n">1</span>) <span class="op">%</span> <span class="fn">len</span>(messages)
    <span class="fn">wait</span>(<span class="n">1200</span>)</code></pre>

    <h3>Low-health warning system</h3>
    <pre><code><span class="k">def</span> <span class="fn">check_players</span>():
    <span class="k">for</span> name <span class="k">in</span> <span class="fn">player_list</span>():
        hp <span class="op">=</span> <span class="fn">player_health</span>(name)
        <span class="k">if</span> hp <span class="op">&lt;</span> <span class="n">4</span>:
            /title {name} actionbar {"&sect;cCritical HP: " + str(int(hp)) + "&hearts;"}

<span class="k">while</span> <span class="k">True</span>:
    <span class="fn">check_players</span>()
    <span class="fn">wait</span>(<span class="n">10</span>)</code></pre>

    <h3>Entity janitor</h3>
    <pre><code>MAX_ZOMBIES <span class="op">=</span> <span class="n">20</span>
<span class="k">while</span> <span class="k">True</span>:
    cnt <span class="op">=</span> <span class="fn">entity_count</span>(<span class="s">"@e[type=zombie]"</span>)
    <span class="k">if</span> cnt <span class="op">&gt;</span> MAX_ZOMBIES:
        /kill @e[type=zombie,sort=furthest,limit={cnt - MAX_ZOMBIES}]
        /say Cleared {cnt - MAX_ZOMBIES} excess zombies.
    <span class="fn">wait</span>(<span class="n">600</span>)</code></pre>

    <h3>Library + importer pattern</h3>
    <pre><code><span class="c"># lib/rewards.script</span>
<span class="a">@LIBRARY</span>
<span class="k">def</span> <span class="fn">give_starter_kit</span>(player):
    /give {player} minecraft:iron_sword <span class="n">1</span>
    /give {player} minecraft:bread <span class="n">16</span>

<span class="c"># welcome.script</span>
<span class="k">from</span> lib.rewards <span class="k">import</span> give_starter_kit
<span class="k">for</span> name <span class="k">in</span> <span class="fn">player_list</span>():
    <span class="fn">give_starter_kit</span>(name)</code></pre>

    <div class="callout warning"><strong>Note:</strong> List comprehensions are not supported. Use a <code>for</code> loop and <code>list.append()</code> instead.</div>
  </section>

</main>

<script>
  const links = document.querySelectorAll('nav a');
  const sections = document.querySelectorAll('section, .hero');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        links.forEach(l => l.classList.remove('active'));
        const id = entry.target.id || 'overview';
        const active = document.querySelector(`nav a[href="#${id}"]`);
        if (active) active.classList.add('active');
      }
    });
  }, { rootMargin: '-20% 0px -60% 0px' });
  sections.forEach(s => observer.observe(s));
</script>
</body>
</html>
